<!DOCTYPE html>
<html ng-app="jrzhApp" ng-controller="jrzhCtrl">

	<head>
		<meta charset="utf-8">
		<title>圈子 - 详情</title>
		<meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1,user-scalable=no">
		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black">

		<link rel="stylesheet" href="../../../css/libs/mui.min.css">
		<link rel="stylesheet" type="text/css" href="../../../css/style.css" />
		<link rel="stylesheet" type="text/css" href="../../../css/fonts/iconfont.css" />
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">日记详情</h1>
			<button id="newDiary" class="mui-btn mui-btn-blue mui-pull-right">写日记</button>
		</header>
		<div class="mui-content circle-content">
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a href="">
						日记名称
						<span class="mui-pull-right" ng-bind="diaryInfo.title">1234</span>
					</a>
				</li>
				<li class="mui-table-view-cell">
					<a href="">
						创建日期
						<span class="mui-pull-right" ng-bind="diaryInfo.updateTime | date:'yyyy-MM-dd'">1234</span>
					</a>
				</li>
				<li class="mui-table-view-cell interfix">
					<p class="text-title">相关服务</p>
					<a href="javascript:;" class="mui-navigate-right view-item serving-info-page">
						<img class="mui-media-object mui-pull-left" src="../../../imgs/temp/1.jpg">
						<div class="mui-media-body">
							健康管理中心
							<p class="min-text">
								健康是人类最宝贵的财富。有了健康与活力，人生便有无限的...
							</p>
						</div>
					</a>
				</li>
			</ul>
			<ul class="mui-table-view mui-table-view-gk">
				<li class="mui-table-view-cell">
					<a href="#sheet1" class="mui-navigate-right" id="isPublicBtn">
						<label>是否公开日记</label>
						<span class="mui-pull-right">公开</span>
					</a>
				</li>
			</ul>
		</div>
		<div class="circle-cont">

			<div class="diarys-page-item">
				<div class="diary-date">2017-5-19</div>
				<p>太空核磁共振仪由俄罗斯太空总署所研发，是一个能够藉由体内组织、个别细胞所发出独特生物波的特殊性来追踪身体状态的仪器融合光谱共振分析、量子共振分析、音频共振分析的光波共振细胞能量比对健康评量系统，此系统是以诺贝尔奖“核磁共振”的理论为基础所研发出来的。太空诊断仪器将提供您非侵入</p>
				<img src="../../../imgs/temp/exp/tx.jpg" />
				<img src="../../../imgs/temp/exp/tx.jpg" />
				<img src="../../../imgs/temp/exp/tx.jpg" />
				<img src="../../../imgs/temp/exp/tx.jpg" />
				<!--<div class="circle-footer">
					<div class="footer-icon mui-pull-left">
						<span><i class="iconfont icon-browse"></i>3572</span>
						<span><i class="iconfont icon-good"></i>3572</span>
					</div>
					<div class="footer-icon mui-pull-right">
						<p class="time">发布日期：2017-5-6</p>
					</div>
					<div class="clear"></div>
				</div>-->
			</div>

		</div>
		<div class="circle-discuss">
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">全部评论</li>
			</ul>
			<ul class="mui-table-view circle-list">

				<li class="circle-item">
					<a href="javascript:void(0)" class="mui-control-item">
						<div class="top" class=" go-pson-home-page">
							<div class="l">
								<img class="tx" src="../../../imgs/temp/1.jpg" alt="" />
								<span>小泽777</span>
							</div>
							<div class="r">
								<span>2017-5-6</span>
							</div>
						</div>
						<div class="cont">
							<p>太空核磁共振仪由俄罗斯太空总署所研发，是一个能够藉由体内组织、个别细胞所发出独特生物波的特殊性来追踪身体状态的仪器融</p>
						</div>
					</a>
					<div class="reply">
						<strong>姓名：</strong>
						<p>回复内容</p>
					</div>
				</li>
				<li class="circle-item">
					<a href="javascript:void(0)" class="mui-control-item">
						<div class="top" class=" go-pson-home-page">
							<div class="l">
								<img class="tx" src="../../../imgs/temp/1.jpg" alt="" />
								<span>小泽777</span>
							</div>
							<div class="r">
								<span>2017-5-6</span>
							</div>
						</div>
						<div class="cont">
							<p>太空核磁共振仪由俄罗斯太空总署所研发，是一个能够藉由体内组织、个别细胞所发出独特生物波的特殊性来追踪身体状态的仪器融</p>
						</div>
					</a>
					<div class="reply">
						<strong>姓名：</strong>
						<p>回复内容</p>
					</div>
				</li>

			</ul>
			<p class="current-all-info">已显示全部内容</p>
			<br />
			<br />
			<br />
		</div>

		<!--弹出面板 actionsheet-->
		<div id="sheet1" class="mui-popover mui-popover-bottom mui-popover-action ">
			<!-- 可选择菜单 -->
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a id="PubilcDiaryOn" href="#">公开</a>
				</li>
				<li class="mui-table-view-cell">
					<a id="PubilcDiaryOff" href="#">不公开</a>
				</li>
			</ul>
			<!-- 取消菜单 -->
			<ul class="mui-table-view">
				<li class="mui-table-view-cell">
					<a href="#sheet1"><b>取消</b></a>
				</li>
			</ul>
		</div>
		<script src="../../../js/mui.min.js"></script>
		<script src="../../../js/angular.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../../js/JRZH.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../../js/common.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../../js/app.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../../js/appdata.js" type="text/javascript" charset="utf-8"></script>
		<script src="../../../js/mui.pullToRefresh.js"></script>
		<script src="../../../js/mui.pullToRefresh.material.js"></script>
		<script>
			mui.init();
			angular.module("jrzhApp", [])
				.controller("jrzhCtrl", function($scope) {

					$scope.member = {};
					$scope.replyList = {}; //评论
					$scope.memberRecord = {}; //相关订单
					$scope.isFans = {}; //是否关注
					$scope.viewList = {}; //日记内容
					$scope.diaryInfo = {}; //日记本
					$scope.totalInfo = {}; //评论、点赞、关注统计

					var state = app.getState();
					//预加载写日记页
					mui.preload({
						url: "writeDiary.html",
						id: "account-circle-writeDiary",
						//						extras: {
						//							diaryId: diaryId
						//						}
					});

					//添加diaryInfo自定义事件监听  
					window.addEventListener('getDiaryInfo', function(event) {
						//获得事件参数  
						var diaryInfo = event.detail.diaryInfo;
						//初始化页面数据
						infoInit(diaryInfo.id, diaryInfo);
					});

					function infoInit(diaryId, diaryInfo) {
						$scope.diaryInfo = diaryInfo;
						//数据加载
						appData.getDetails({
							userId: state.userId,
							diaryId: diaryId
						}, function(response) {
							var viewlist = response.object.viewList || [];
							$scope.member = response.object.member; //个人信息
							$scope.replyList = response.object.replyList; //评论
							$scope.memberRecord = response.object.memberRecord; //服务
							$scope.isFans = response.object.isFans; //是否关注
							$scope.viewList = response.object.viewList; //日记内容

							$scope.$apply(); //数据更新view
						}, function(err) {
							mui.toast(err.message);
						});
					};

					//添加日记
					var newDiaryButton = document.querySelectorAll("#newDiary")[0];
					newDiaryButton.addEventListener("tap", function() {
						mui.openWindow({
							url: "writeDiary.html",
							id: "account-circle-writeDiary",
						})
					});

					mui.plusReady(function() {
						var currWebView = plus.webview.currentWebview();
					});

					var PubilcDiaryOn = document.querySelectorAll("#PubilcDiaryOn")[0];
					var PubilcDiaryOff = document.querySelectorAll("#PubilcDiaryOff")[0];
					var isPublicBtn = document.querySelectorAll("#isPublicBtn")[0];
					PubilcDiaryOn.addEventListener("tap", function() {
						isPublicDiary(true);
					});
					PubilcDiaryOff.addEventListener("tap", function() {
						isPublicDiary(false);
					});

					function isPublicDiary(ispublic) {
						mui('#sheet1').popover('toggle');
						var spanElem = isPublicBtn.getElementsByClassName("mui-pull-right")[0];
						spanElem.innerHTML = ispublic ? "公开" : "不公开";
					}

				});
		</script>
	</body>

</html>